!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("commajs-core")):"function"==typeof define&&define.amd?define(["commajs-core"],t):"object"==typeof exports?exports.CommaOutline=t(require("commajs-core")):e.CommaOutline=t(e["commajs-core"])}(window,function(o){return l={},r.m=n=[function(e,t){e.exports=o},function(e,t,o){"use strict";o.r(t),o.d(t,"default",function(){return d});var r=o(0);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(l){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,o,n,r=c(l);return t=i?(e=c(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments),o=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(o):n}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=void 0,d=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,r["Plugin"]);var n=a(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var o=(t=n.call(this,e)).GetIdTarget();return null!=o&&""!=o?null==t.rootNode.document.GetNodeById(o)&&t.SetIdTarget():s.CleanNodeFromPlugin(t.rootNode),t}return l(s,null,[{key:"GetName",value:function(){return"outline"}}]),l(s,[{key:"SetIdTarget",value:function(){this.rootNode.domElement.setAttribute("cm-outline-id-target",this.rootNode.id)}},{key:"GetIdTarget",value:function(){return this.rootNode.domElement.getAttribute("cm-outline-id-target")}},{key:"GetLevel",value:function(){return this.rootNode.domElement.getAttribute("cm-outline-level")}},{key:"ManageEnter",value:function(){var e=void 0,t=!0;0==this.rootNode.document.GetCursorPosition().startOffset?(e=this.rootNode.InsertEmptyBlockNodeBefore("div"),t=!1):e=this.rootNode.InsertEmptyBlockNodeAfter("div");var o=r.TextNode.CreateNew(this.rootNode.document,"span","",this.rootNode.document.GetDefaultNodeStyle());return e.Append(o),t?o.SetFocus():this.rootNode.GetFirstTextNode().SetFocus(),!0}},{key:"Fire",value:function(e,t){if(e===r.PluginActions.ENTER)return this.ManageEnter(t)}}],[{key:"CleanNodeFromPlugin",value:function(e){var t=e.document,o=void 0;t.RemovePluginInstance(e.id);var n=e.domElement.getAttribute("cm-outline-level");return e.children.forEach(function(e){e.isTextNode()&&(null==o&&(o=e),"h1"==n.toLowerCase()?e.ToggleStyle("headerOne",void 0,!0):"h2"==n.toLowerCase()?e.ToggleStyle("headerTwo",void 0,!0):"h3"==n.toLowerCase()?e.ToggleStyle("headerThree",void 0,!0):n.toLowerCase(),e.ApplyNodeStyle(t.GetDefaultNodeStyle()))}),e.RemoveAttribute("cm-outline-id-target"),e.RemoveAttribute("cm-outline-level"),o}},{key:"CreateNew",value:function(t,e){var o=e,n=t.GetSelectedLines()[0],r=void 0,l=void 0;return null!=n&&("outline"==n.GetPluginType()&&(l=s.CleanNodeFromPlugin(n)),n.id,n.children.forEach(function(e){e.isTextNode()&&(null==l&&(l=e),"h1"==o.toLowerCase()?e.ToggleStyle("headerOne",void 0,!0):"h2"==o.toLowerCase()?e.ToggleStyle("headerTwo",void 0,!0):"h3"==o.toLowerCase()?e.ToggleStyle("headerThree",void 0,!0):"normal"==o.toLowerCase()&&e.ApplyNodeStyle(t.GetDefaultNodeStyle()))}),"normal"!=o.toLowerCase()&&(n.AddAttribute("cm-outline-id-target",n.id),n.AddAttribute("cm-outline-level",o),r=new s(n))),t.FireStyleChanged(),null!=l&&l.SetFocus(),r}},{key:"ParseDocument",value:function(e,r){e.children.forEach(function(e){var t,o,n;e.isBlockNode()&&(null!=e.GetPluginType()&&"outline"==e.GetPluginType().toLowerCase()?(t=e.domElement.getAttribute("cm-outline-id-target"),o=e.domElement.getAttribute("cm-outline-level"),n=e.domElement.textContent,r.push({idTarget:t,level:o,label:n})):s.ParseDocument(e,r))})}},{key:"OpenNavigationPanel",value:function(n){var e,r,t,o,l,i,u,a,c,d;null!=f?(document.body.removeChild(f),f=void 0):(e=[],s.ParseDocument(n.rootNode,e),r=document.createElement("div"),l=(o=(t=n.nodeContainer).getBoundingClientRect()).width/2,i=o.height,r.style.backgroundColor="#ffffff",r.style.border="1px solid #e3e3e3",r.style.boxShadow="0 4px 8px 0 rgba(0, 0, 0, 0.2)",r.style.position="absolute",r.style.top=window.scrollY+o.top+t.parentNode.scrollTop+"px",r.style.left=window.scrollX+o.left+"px",r.style.width="0px",r.style.maxHeight=i+"px",r.style.overflow="hidden",r.style.opacity=0,r.style.zIndex="999",(u=document.createElement("div")).style.display="flex",u.style.alignItems="center",u.style.height="46px",(a=document.createElement("div")).innerHTML="Table of Contents",a.style.flex="1",a.style.color="#9298a1",a.style.padding="10px",a.style.fontSize="14px",a.style.fontFamily="Arial",u.appendChild(a),(c=document.createElement("i")).setAttribute("class","fa fa-times"),c.style.color="#9298a1",c.style.cursor="pointer",c.style.margin="10px",c.addEventListener("mouseover",function(e){this.style.color="#30b7e8"}),c.addEventListener("mouseout",function(e){this.style.color="#9298a1"}),c.addEventListener("click",function(e){document.body.removeChild(r),f=void 0}),u.appendChild(c),r.appendChild(u),(d=document.createElement("div")).style.overflow="auto",d.style.maxHeight=i-46+"px",0==e.length?(d.innerHTML="Headings you add to the document will appear here",d.style.color="#9298a1",d.style.textAlign="center",d.style.padding="0px 20px 20px 20px",d.style.fontSize="16px",d.style.fontFamily="Arial",d.style.fontStyle="italic"):(d.style.padding="0px 0px 20px 0px",e.forEach(function(o){var e=document.createElement("div");e.innerHTML=o.label,e.style.color="#21252b",e.style.fontSize="16px",e.style.fontFamily="Arial",e.style.cursor="pointer","h1"==o.level?(e.style.margin="4px 0px 0px 0px",e.style.padding="5px 10px 5px 10px",e.style.fontWeight="bold"):"h2"==o.level?e.style.padding="5px 10px 5px 30px":e.style.padding="5px 10px 5px 44px",e.addEventListener("mouseover",function(e){this.style.color="#30b7e8",this.style.backgroundColor="#f7f7f7"}),e.addEventListener("mouseout",function(e){this.style.color="#21252b",this.style.backgroundColor="#ffffff"}),e.addEventListener("click",function(e){var t=n.GetNodeById(o.idTarget).GetFirstTextNode();t.domElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),t.SetFocus(),document.body.removeChild(r),f=void 0}),d.appendChild(e)})),r.appendChild(d),document.body.appendChild(r),f=r,s.ShowPnl(r,parseInt(l),parseInt(i)))}},{key:"ShowPnl",value:function(e,t,o){var n=parseInt(e.style.width.replace("px","")),r=parseInt(e.style.height.replace("px","")),l=!0;n<t&&(l=!1,n+=parseInt(t/10),t<n&&(n=t,l=!0)),r<o&&(l=!1,r+=parseInt(o/10),o<r&&(r=o,l=!0));var i=parseFloat(e.style.opacity);1<(i+=.1)&&(i=1),e.style.width=n+"px",e.style.opacity=i,l||setTimeout(function(){s.ShowPnl(e,t,o)},20)}}]),s}()}],r.c=l,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=1);function r(e){if(l[e])return l[e].exports;var t=l[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n,l});